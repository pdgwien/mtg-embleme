"use strict";angular.module("mtgEmblemsApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","firebase"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/play/:gameId",{templateUrl:"views/play.html",controller:"HostCtrl"}).when("/watch/:gameId",{templateUrl:"views/watch.html",controller:"WatchCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]);var shuffleArray=function(a,b){var c,d,e=a.length,f=null;for(f=b===!1?new Math.seedrandom:new Math.seedrandom(b);e;)d=Math.floor(f()*e--),c=a[e],a[e]=a[d],a[d]=c;return a},makeId=function(a){for(var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;a>d;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b};angular.module("mtgEmblemsApp").controller("MainCtrl",["$scope","$http",function(a,b){var c=null;a.show_emblems=[],a.index=0,a.rounds=0,a.reset=function(){a.show_emblems=[],shuffleArray(a.emblems,!1),a.rounds=0,a.index=0},a.next=function(b,c){var d,e=0,f=!1,g=null;if(g=a.getRandomCard(),b&&(g.type="permanent"),c?g.is_automatic=!0:a.rounds++,a.show_emblems.push(g),g.draw_others>0)for(e=g.draw_others,g.permanent&&(f=g.permanent),d=0;e>d;d++)a.next(f,!0)},a.getRandomCard=function(){var b=Math.floor(c()*a.emblems.length),d=JSON.parse(JSON.stringify(a.emblems[b]));return d.id=a.index++,d.type="standard",d},b.get("./data/emblems.json").success(function(b){a.emblems=b,shuffleArray(a.emblems,!1),c=new Math.seedrandom}).error(function(){})}]),angular.module("mtgEmblemsApp").controller("AboutCtrl",["$scope",function(){}]),angular.module("mtgEmblemsApp").filter("manaSymbols",["$sce",function(a){return function(b){var c=b.replace(/\{([0-9BWRUGPSTQXYZ]+)\}/g,function(a,b){return'<i class="mana nk_icon_'+b.toLowerCase()+'" title="'+a+'"></i>'});return a.trustAsHtml(c)}}]),angular.module("mtgEmblemsApp").controller("HeaderCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("mtgEmblemsApp").controller("HostCtrl",["$scope","$routeParams","$http","$firebase",function(a,b,c,d){var e=new Firebase("https://mtg-emblems.firebaseio.com/"+b.gameId),f=d(e),g=d(e.child("emblems")),h=(d(e.child("metadata")),null);a.show_emblems=g.$asArray(),a.index=0,a.rounds=0,a.reset=function(){f.$remove(),shuffleArray(a.emblems),a.rounds=0,a.index=0},a.next=function(b,c){var d,e=0,f=!1,g=null;if(g=a.getRandomCard(),b&&(g.type="permanent"),c?g.is_automatic=!0:a.rounds++,a.show_emblems.$add(g),g.draw_others>0)for(e=g.draw_others,g.permanent&&(f=g.permanent),d=0;e>d;d++)a.next(f,!0)},a.getRandomCard=function(){var b=Math.floor(h()*a.emblems.length),c=JSON.parse(JSON.stringify(a.emblems[b]));return c.id=a.index++,c.type="standard",c},c.get("./data/emblems.json").success(function(b){a.emblems=b,shuffleArray(a.emblems),h=new Math.seedrandom}).error(function(){})}]),angular.module("mtgEmblemsApp").controller("WatchCtrl",["$scope","$routeParams","$firebase",function(a,b,c){var d=new Firebase("https://mtg-emblems.firebaseio.com/"+b.gameId),e=c(d.child("emblems"));a.show_emblems=e.$asArray()}]);