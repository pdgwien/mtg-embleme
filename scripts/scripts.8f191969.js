"use strict";angular.module("mtgEmblemsApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","firebase"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/play/:gameId",{templateUrl:"views/play.html",controller:"HostCtrl"}).when("/watch/:gameId",{templateUrl:"views/watch.html",controller:"WatchCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]);var shuffleArray=function(a,b){var c,d,e=a.length,f=null;for(f=b===!1?new Math.seedrandom:new Math.seedrandom(b);e;)d=Math.floor(f()*e--),c=a[e],a[e]=a[d],a[d]=c;return a},makeId=function(a){for(var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;a>d;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b};angular.module("mtgEmblemsApp").controller("MainCtrl",["$scope","$http",function(a,b){a.show_emblems=[],a.emblem_index=0,a.total_index=0,a.rounds=0,a.reset=function(){a.show_emblems=[],shuffleArray(a.emblems,!1),shuffleArray(a.all_emblems,!1),a.rounds=0,a.total_index=0,a.emblem_index=0},a.next=function(b,c){var d,e=0,f=!1,g=null;if(a.emblem_index>=a.emblems.length-1?(shuffleArray(a.emblems,!1),a.emblem_index=0):a.emblem_index++,b?(shuffleArray(a.all_emblems,!1),g=JSON.parse(JSON.stringify(a.all_emblems[0]))):g=JSON.parse(JSON.stringify(a.emblems[a.emblem_index])),g.id=a.total_index,a.total_index++,g.type=b?"permanent":"standard",c?g.is_automatic=!0:a.rounds++,a.show_emblems.push(g),a.emblems[a.emblem_index].draw_others>0)for(e=a.emblems[a.emblem_index].draw_others,a.emblems[a.emblem_index].permanent&&(f=a.emblems[a.emblem_index].permanent),d=0;e>d;d++)a.next(f,!0)},b.get("/data/emblems.json").success(function(b){a.all_emblems=b,a.emblems=b,shuffleArray(a.emblems,!1),shuffleArray(a.all_emblems,!1)}).error(function(){})}]),angular.module("mtgEmblemsApp").controller("AboutCtrl",["$scope",function(){}]),angular.module("mtgEmblemsApp").filter("manaSymbols",["$sce",function(a){return function(b){var c=b.replace(/\{([0-9BWRUGPSTQXYZ]+)\}/g,function(a,b){return'<i class="mana nk_icon_'+b.toLowerCase()+'" title="'+a+'"></i>'});return a.trustAsHtml(c)}}]),angular.module("mtgEmblemsApp").controller("HeaderCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("mtgEmblemsApp").controller("HostCtrl",["$scope","$routeParams","$http","$firebase",function(a,b,c,d){{var e=new Firebase("https://mtg-emblems.firebaseio.com/"+b.gameId),f=d(e),g=d(e.child("emblems"));d(e.child("metadata"))}a.show_emblems=g.$asArray(),a.emblem_index=0,a.total_index=0,a.rounds=0,a.reset=function(){f.$remove(),shuffleArray(a.emblems),shuffleArray(a.all_emblems),a.rounds=0,a.total_index=0,a.emblem_index=0},a.next=function(b,c){var d,e=0,f=!1,g=null;if(a.emblem_index>=a.emblems.length-1?(shuffleArray(a.emblems),a.emblem_index=0):a.emblem_index++,b?(shuffleArray(a.all_emblems),g=JSON.parse(JSON.stringify(a.all_emblems[0]))):g=JSON.parse(JSON.stringify(a.emblems[a.emblem_index])),g.id=a.total_index,a.total_index++,g.type=b?"permanent":"standard",c?g.is_automatic=!0:a.rounds++,a.show_emblems.$add(g),a.emblems[a.emblem_index].draw_others>0)for(e=a.emblems[a.emblem_index].draw_others,a.emblems[a.emblem_index].permanent&&(f=a.emblems[a.emblem_index].permanent),d=0;e>d;d++)a.next(f,!0)},c.get("/data/emblems.json").success(function(b){a.all_emblems=b,a.emblems=b,shuffleArray(a.emblems),shuffleArray(a.all_emblems)}).error(function(){})}]),angular.module("mtgEmblemsApp").controller("WatchCtrl",["$scope","$routeParams","$firebase",function(a,b,c){var d=new Firebase("https://mtg-emblems.firebaseio.com/"+b.gameId),e=c(d.child("emblems"));a.show_emblems=e.$asArray()}]);